{% import (
  "fmt"
  "strings"
  "time"

  "github.com/google/uuid"

  "{{{ .Package }}}/app/controller/cutil"
  "{{{ .Package }}}/app/util"
  "{{{ .Package }}}/views/vutil"
) %}

{% func TableInput(key string, id string, title string, value string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInput(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputPassword(key string, id string, title string, value string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputPassword(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputNumber(key string, id string, title string, value int, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputNumber(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputFloat(key string, id string, title string, value float64, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputFloat(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputTimestamp(key string, id string, title string, value *time.Time, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputTimestamp(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputTimestampDay(key string, id string, title string, value *time.Time, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputTimestampDay(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputUUID(key string, id string, title string, value *uuid.UUID, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputUUID(key, id, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableTextarea(key string, id string, title string, rows int, value string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormTextarea(key, id, rows, value, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableSelect(key string, id string, title string, value string, opts []string, titles []string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormSelect(key, id, value, opts, titles, indent) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableDatalist(key string, id string, title string, value string, opts []string, titles []string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormDatalist(key, id, value, opts, titles, indent) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputTags(key string, id string, title string, values []string, ps *cutil.PageState, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormInputTags(key, id, values, ps, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableFileUpload(key string, id string, title string, indent int, help ...string) %}{% stripspace %}
  {%- code id = cutil.CleanID(key, id) -%}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label for="{%s id %}"{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= FormFileUpload(key, id, indent, help...) %}</td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableRadio(key string, title string, value string, opts []string, titles []string, indent int, help ...string) %}{% stripspace %}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label{%= titleFor(help) %}>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>
      {%= FormRadio(key, value, opts, titles, indent + 2) %}
    {%= vutil.Indent(true, indent + 1) %}
    </td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableBoolean(key string, title string, value bool, indent int, help ...string) %}{% stripspace %}
  {%= TableRadio(key, title, fmt.Sprint(value), []string{"true", "false"}, []string{"True", "False"}, indent) %}
{% endstripspace %}{% endfunc %}

{% func TableCheckbox(key string, title string, values []string, opts []string, titles []string, indent int, help ...string) %}{% stripspace %}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>
      {%= FormCheckbox(key, values, opts, titles, indent + 2) %}
    {%= vutil.Indent(true, indent + 1) %}
    </td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableInputFile(key string, id string, title string, label string, value string) %}{% stripspace %}
  <tr>
    <th class="shrink"><label for="{%s id %}">{%s title %}</label></th>
    <td>
      {%= FormInputFile(key, id, label, value) %}
    </td>
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableRichEditor(key string, id string, title string, columns []*util.FieldDesc, value []any, placeholder ...string) %}{% stripspace %}
  <tr>
    <th class="shrink"><label for="{%s id %}">{%s title %}</label></th>
    <td>
      {%= FormRichEditor(key, id, columns, value, placeholder...) %}
    </td>
  </tr>
{% endstripspace %}{% endfunc %}

{% func TableIcons(key string, title string, value string, ps *cutil.PageState, indent int, help ...string) %}{% stripspace %}
  <tr>
    {%= vutil.Indent(true, indent + 1) %}
    <th class="shrink"><label>{%s title %}</label></th>
    {%= vutil.Indent(true, indent + 1) %}
    <td>{%= IconPicker(key, value, ps, indent + 2) %}
    </td>
  {%= vutil.Indent(true, indent) %}
  </tr>
{% endstripspace %}{% endfunc %}

{% func titleFor(help []string) %}{% stripspace %}
  {% if len(help) > 0 %}{% space %}title="{%s strings.Join(help, "; ") %}"{% endif %}
{% endstripspace %}{% endfunc %}
